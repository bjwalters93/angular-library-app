<div class="pt-3 pl-10 pr-10 pb-10">
  @if (books$ | async; as books) {
  <p-table
    [value]="books"
    showGridlines
    selectionMode="single"
    [(selection)]="selectedBook"
    dataKey="id"
    (onRowSelect)="onRowSelect($event)"
    (onRowUnselect)="onRowUnselect($event)"
    [tableStyle]="{ 'min-width': '60rem' }"
  >
    <ng-template #caption>
      <div class="flex items-center justify-between">
        <span class="text-xl font-bold ml-4"
          >Books Inventory: {{ books ? books.length : 0 }}</span
        >
        <p-iconfield iconPosition="left" class="ml-auto">
          <p-inputicon>
            <i class="pi pi-search"></i>
          </p-inputicon>
          <input
            pInputText
            pSize="small"
            type="text"
            placeholder="Search keyword"
          />
        </p-iconfield>
      </div>
    </ng-template>
    <ng-template #header>
      <tr>
        <th>Id</th>
        <th>Title</th>
        <th>Author</th>
        <th>Cover</th>
        <th>Available Copies</th>
        <th>Total Copies</th>
        <th>Status</th>
        <th style="width: 5rem"></th>
      </tr>
    </ng-template>
    <ng-template #body let-book>
      <tr [pSelectableRow]="book">
        <td>{{ book.id }}</td>
        <td>{{ book.title }}</td>
        <td>{{ book.author }}</td>
        <td>
          <div class="flex items-center gap-2">
            <img
              alt="book cover"
              [src]="book.imageUrl"
              style="
                width: 32px;
                height: 32px;
                border-radius: 50%;
                object-fit: cover;
                border: 2px solid #ddd;
              "
            />
          </div>
        </td>
        <td>
          {{ book.availableCopies }}
        </td>
        <td>{{ book.totalCopies }}</td>
        <td>
          <p-tag [severity]="setStatus(book).severity">{{
            setStatus(book).text
          }}</p-tag>
        </td>
        <td>
          <p-button
            icon="pi pi-eye"
            severity="info"
            rounded
            size="small"
            label="View"
            [link]="true"
            [routerLink]="['/books', book.id]"
          />
        </td>
      </tr>
    </ng-template>
  </p-table>
  } @else {
  <p-table [value]="skeltonArray" [tableStyle]="{ 'min-width': '60rem' }">
    <ng-template #caption>
      <div class="flex items-center justify-between">
        <span class="text-xl font-bold ml-4">Books Inventory: </span>
        <p-iconfield iconPosition="left" class="ml-auto">
          <p-inputicon>
            <i class="pi pi-search"></i>
          </p-inputicon>
          <input
            pInputText
            pSize="small"
            type="text"
            placeholder="Search keyword"
          />
        </p-iconfield>
      </div>
    </ng-template>
    <ng-template #header>
      <tr>
        <th>Id</th>
        <th>Title</th>
        <th>Author</th>
        <th>Cover</th>
        <th>Available Copies</th>
        <th>Total Copies</th>
        <th>Status</th>
        <th style="width: 5rem"></th>
      </tr>
    </ng-template>
    <ng-template #body let-book>
      <tr [pSelectableRow]="book">
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td>
          <p-skeleton />
        </td>
        <td>
          <p-skeleton />
        </td>
        <td><p-skeleton /></td>
        <td>
          <p-skeleton />
        </td>
        <td>
          <p-skeleton />
        </td>
      </tr>
    </ng-template>
  </p-table>
  }
</div>
